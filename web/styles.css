:root { --bg:#0f1115; --fg:#e6e6e6; --muted:#9094a1; --accent:#79c0ff; --card:#171923; --good:#2faa60; --bad:#d84a4a; --default:#636a7b; --grid:#2a2f44; --grid2:#1e2235; --cursor:#ff4d4d; }
* { box-sizing: border-box; }
body { margin:0; background:var(--bg); color:var(--fg); font:14px/1.4 system-ui,Segoe UI,Roboto,Helvetica,Arial; }
.topbar { display:flex; justify-content:space-between; align-items:center; padding:8px 12px; background:#11131a; border-bottom:1px solid #1f2330; }
.topbar .left>* { margin-right:8px; }
.badge { background:#1e2230; color:#a8b3cf; padding:2px 8px; border-radius:999px; }
.muted { color:var(--muted); margin-left:8px; }
.btn { background:#22263a; color:#e6e6e6; border:1px solid #2c3150; padding:6px 10px; border-radius:8px; cursor:pointer; }
.btn:hover { background:#262b44; }
.btn.danger { border-color:#5b2626; background:#2b1e1e; color:#f0caca; }
.workspace { display:flex; height: calc(100vh - 48px); }
.palette { width:260px; padding:12px; border-right:1px solid #1f2330; background:#11131a; overflow:auto; }
.palette .btn { width:100%; margin:6px 0; }
.page-controls { display:flex; gap:8px; margin-top:6px; }
.canvas { flex:1; position:relative; overflow:auto; padding:12px; }
.widget { position:absolute; display:flex; flex-direction:column; background:var(--card); border:1px solid #262a3e; border-radius:12px; min-width:280px; min-height:180px; }
.widget header { display:flex; align-items:flex-start; gap:8px; padding:8px; cursor:grab; }
.widget header .title { font-weight:600; }
.widget header .spacer { flex:1; }
.widget header .opts { display:flex; flex-wrap:wrap; gap:8px; align-items:center; color:#a8b3cf; max-width:60%; }
.widget header .tools { display:flex; gap:6px; }
.widget .body { flex:1; min-height:0; padding:8px; }
.widget canvas { width:100%; height:100%; }
legend { color:#a8b3cf; padding:0 6px; }
.legend { display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:2px 0 4px; }
.legend .item { display:flex; gap:6px; align-items:center; }
.legend .swatch { width:12px; height:12px; border-radius:2px; background:#888; }
.do-btn { width:100%; padding:10px; border-radius:10px; border:1px solid #2d334f; font-weight:700; }
.do-btn.default { background:#2b3046; color:#bcc4e0; border-color:#384064; }
.do-btn.inactive { background:#132619; color:#cfead8; border-color:#1e3b28; }
.do-btn.active { background:#2a1212; color:#f1c5c5; border-color:#4a2222; }
.icon { background:#1e2235; border:1px solid #2a3048; color:#cfd6f0; border-radius:8px; padding:4px 8px; cursor:pointer; user-select:none; }
.icon:hover { background:#242a4a; }
.resize { position:absolute; right:6px; bottom:6px; width:14px; height:14px; border-right:2px solid #3e4668; border-bottom:2px solid #3e4668; cursor:nwse-resize; opacity:0.7; }
.row { display:flex; gap:8px; align-items:center; }
.row>* { flex:1; }
hr.soft { border:0; border-top:1px solid #1f2330; margin:6px 0; }
.small { font-size:12px; color:#9aa1b9; }

/* Editors */
.modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); }
.modal.hidden { display:none; }
.modal .panel { width:min(1100px, 94vw); max-height:92vh; overflow:auto; padding:14px; border-radius:12px; background:#141828; border:1px solid #2b2f45; resize: both; }
fieldset { border:1px solid #2a3046; border-radius:10px; padding:10px; margin-bottom:10px; }
table.form { width:100%; border-collapse:collapse; }
table.form th, table.form td { border-bottom:1px solid #252a3f; padding:6px; text-align:left; }
table.form th { color:#a8b3cf; font-weight:600; }
table.form input, table.form select { width:100%; font-size:12px; padding:4px 6px; }
.compact .form input, .compact .form select { font-size:12px; padding:3px 5px; }

/* Chart context menu */

.ctx.persistent {
  position: fixed;
  z-index: 10000;
}

.ctx-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 8px;
  border-bottom: 1px solid #2b3154;
  margin: -6px -6px 6px -6px;
  background: #1a1e35;
  border-radius: 8px 8px 0 0;
}

.ctx-header h4 {
  margin: 0;
  flex: 1;
}

.ctx-close {
  background: transparent;
  border: none;
  color: #cfd6f0;
  font-size: 20px;
  line-height: 1;
  cursor: pointer;
  padding: 0 4px;
  margin-left: 8px;
}

.ctx-close:hover {
  color: #ff6b6b;
  background: rgba(255, 107, 107, 0.1);
  border-radius: 4px;
}

.ctx { position:absolute; z-index:9999; background:#121526; border:1px solid #2b3154; border-radius:8px; padding:6px; min-width:220px; box-shadow:0 10px 30px rgba(0,0,0,0.4); }
.ctx h4 { margin:6px 8px; font-size:13px; color:#cfd6f0; }
.ctx .row { padding:4px 8px; }
.ctx label { display:flex; align-items:center; gap:8px; font-size:13px; }
.ctx table { width:100%; border-collapse:collapse; margin-top:4px; }
.ctx th, .ctx td { padding:4px 6px; border-bottom:1px solid #1d2237; font-size:12px; color:#a8b3cf; }

/* Add these CSS rules to styles.css: */
.script-table { font-size: 13px; }
.script-table input[type="number"],
.script-table select { padding: 4px; }
.script-table td { vertical-align: middle; }
.script-table button { padding: 4px 8px; font-size: 12px; }

/* Add these rules to the end of your styles.css file */

/* Replay Controls */
.replay-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: #0d0f14;
  border-bottom: 1px solid #1f2330;
  gap: 12px;
}

.replay-left {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
}

.replay-right {
  display: flex;
  align-items: center;
  gap: 12px;
}

.replay-controls input[type="range"] {
  flex: 1;
  min-width: 200px;
  height: 6px;
  background: #1e2235;
  border-radius: 3px;
  outline: none;
}

.replay-controls input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
}

.replay-controls input[type="range"]::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  border: none;
}

.replay-controls input[type="number"] {
  padding: 4px 6px;
  background: var(--card);
  border: 1px solid #2c3150;
  border-radius: 6px;
  color: var(--fg);
}

/* Script Editor Table */
.script-table {
  font-size: 13px;
  width: 100%;
  margin: 12px 0;
}

.script-table input[type="number"],
.script-table select {
  padding: 4px 6px;
  background: var(--card);
  border: 1px solid #2c3150;
  border-radius: 4px;
  color: var(--fg);
  font-size: 13px;
}

.script-table input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.script-table td {
  vertical-align: middle;
  padding: 8px 6px;
}

.script-table button {
  padding: 4px 8px;
  font-size: 12px;
  min-width: 32px;
}

.script-table th {
  background: #1a1d2e;
  padding: 8px 6px;
  font-weight: 600;
  color: #a8b3cf;
  text-align: left;
}

.script-table tbody tr:hover {
  background: rgba(255, 255, 255, 0.02);
}

/* Script Player Controls */
.script-controls {
  display: flex;
  justify-content: flex-start;
  align-items: center;
  padding: 8px 12px;
  background: #0d0f14;
  border-bottom: 1px solid #1f2330;
  gap: 12px;
}

.script-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.script-controls .btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.script-controls .btn:not(:disabled):hover {
  background: #2a3050;
}

/* Status badge colors */
.badge.playing {
  background: #1e3a1e;
  color: #a8f0a8;
  animation: pulse 2s infinite;
}

.badge.paused {
  background: #3a3a1e;
  color: #f0f0a8;
}

.badge.stopped {
  background: #3a1e1e;
  color: #f0a8a8;
}

.badge.ready {
  background: #1e2a3a;
  color: #a8c8f0;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

/* Update workspace height to account for both controls */
.workspace {
  display: flex;
  height: calc(100vh - 96px); /* topbar + script controls */
}

/* When replay controls are visible, adjust */
#replayControls:not([style*="display: none"]) ~ main.workspace {
  height: calc(100vh - 144px); /* topbar + replay + script controls */
}